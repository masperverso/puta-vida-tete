<!DOCTYPE html>
<html>
<head>
  <title>Formulario de Sign In y Login</title>

  <link rel="stylesheet" type="text/css" href="login.css">

  <!-- Agrega el SDK de Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-compat.js"></script>
  <script>
    const firebaseConfig = {
      // Aquí va la configuración de tu proyecto de Firebase (apiKey, authDomain, etc.)
    };

    // Inicializar Firebase App
    firebase.initializeApp(firebaseConfig);

    // Obtener las instancias necesarias
    const auth = firebase.auth();
    const firestore = firebase.firestore();
    const storage = firebase.storage();

    window.register = function() {
      var email = document.getElementById('register-email').value;
      var password = document.getElementById('register-password').value;

      auth.createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Registro exitoso, puedes realizar acciones adicionales o redirigir al usuario a otra página
          console.log('Usuario registrado:', userCredential.user);

          // Obtener el nombre de la carpeta del usuario
          const userFolder = email.split('@')[0]; // Obtiene el nombre de usuario antes del símbolo '@'

          // Crear la carpeta del usuario en Firebase Storage
          const storageRef = storage.ref('users/' + userFolder);
          storageRef.putString('')
            .then(() => {
              console.log('Carpeta de usuario creada');

              // Guardar el estado de autenticación en el almacenamiento local
              localStorage.setItem('userLoggedIn', 'true');

              // Redirigir al usuario al contenido principal
              window.location.href = 'principal.html';
            })
            .catch((error) => {
              console.error('Error al crear la carpeta de usuario:', error);
            });
        })
        .catch((error) => {
          // Ocurrió un error durante el registro, maneja el error apropiadamente
          console.error('Error de registro:', error);
        });
    }
  </script>
</head>
<body>
  <div id="container">
    <h1>Registro Usuario</h1>
    <form>
      <label for="login-email">Correo electrónico:</label>
      <input type="email" id="login-email" required><br>

      <label for="login-password">Contraseña:</label>
      <input type="password" id="login-password" required><br>

      <button type="button" onclick="login()">Entrar</button>
    </form>
  </div>

  <div id="container">
    <h1>Crear una cuenta</h1>
    <form>
      <label for="register-email">Correo electrónico:</label>
      <input type="email" id="register-email" required><br>

      <label for="register-password">Contraseña:</label>
      <input type="password" id="register-password" required><br>

      <button type="button" onclick="register()">Registrarse</button>
    </form>
  </div>

  <script>
    // Puedes agregar más código JavaScript aquí si es necesario
  </script>
</body>
</html>
